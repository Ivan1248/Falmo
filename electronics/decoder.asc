Version 4
SHEET 1 2692 1604
WIRE -800 -480 -800 -496
WIRE 1456 -464 1344 -464
WIRE 480 -448 368 -448
WIRE 1344 -400 1344 -464
WIRE 1360 -400 1344 -400
WIRE 368 -384 368 -448
WIRE 384 -384 368 -384
WIRE 1456 -384 1424 -384
WIRE 1568 -384 1456 -384
WIRE 1776 -384 1648 -384
WIRE -800 -368 -800 -400
WIRE -672 -368 -800 -368
WIRE -576 -368 -672 -368
WIRE 480 -368 448 -368
WIRE 592 -368 480 -368
WIRE 896 -368 672 -368
WIRE 1360 -368 1168 -368
WIRE 1648 -368 1648 -384
WIRE -800 -352 -800 -368
WIRE 48 -352 16 -352
WIRE 208 -352 128 -352
WIRE 384 -352 208 -352
WIRE -672 -336 -672 -368
WIRE -576 -336 -576 -368
WIRE 128 -336 128 -352
WIRE 208 -336 208 -352
WIRE 1344 -336 1344 -400
WIRE 368 -320 368 -384
WIRE 672 -288 672 -304
WIRE -800 -240 -800 -272
WIRE -672 -240 -672 -272
WIRE -672 -240 -800 -240
WIRE -576 -240 -576 -272
WIRE -576 -240 -672 -240
WIRE 128 -240 128 -272
WIRE 208 -240 208 -256
WIRE -800 -224 -800 -240
WIRE 480 -160 368 -160
WIRE 816 -112 800 -112
WIRE 368 -96 368 -160
WIRE 384 -96 368 -96
WIRE 976 -96 880 -96
WIRE 480 -80 448 -80
WIRE 592 -80 480 -80
WIRE 816 -80 672 -80
WIRE -112 -64 -128 -64
WIRE 16 -64 16 -352
WIRE 16 -64 -112 -64
WIRE 48 -64 16 -64
WIRE 208 -64 128 -64
WIRE 384 -64 208 -64
WIRE 672 -64 672 -80
WIRE 128 -48 128 -64
WIRE 208 -48 208 -64
WIRE 368 -32 368 -96
WIRE 128 48 128 16
WIRE 208 48 208 32
WIRE 480 144 368 144
WIRE 816 192 800 192
WIRE 368 208 368 144
WIRE 384 208 368 208
WIRE 976 208 880 208
WIRE 480 224 448 224
WIRE 592 224 480 224
WIRE 816 224 672 224
WIRE 16 240 16 -64
WIRE 48 240 16 240
WIRE 208 240 128 240
WIRE 384 240 208 240
WIRE 672 240 672 224
WIRE 128 256 128 240
WIRE 208 256 208 240
WIRE 368 272 368 208
WIRE 128 352 128 320
WIRE 208 352 208 336
WIRE 480 432 368 432
WIRE 816 480 800 480
WIRE 368 496 368 432
WIRE 384 496 368 496
WIRE 976 496 880 496
WIRE 480 512 448 512
WIRE 592 512 480 512
WIRE 816 512 672 512
WIRE 16 528 16 240
WIRE 48 528 16 528
WIRE 208 528 128 528
WIRE 384 528 208 528
WIRE 672 528 672 512
WIRE 128 544 128 528
WIRE 208 544 208 528
WIRE 368 560 368 496
WIRE 128 640 128 608
WIRE 208 640 208 624
FLAG 672 0 0
FLAG 672 304 0
FLAG 848 -64 0
FLAG 848 -128 V+
FLAG 976 -96 Vsh
FLAG 848 240 0
FLAG 848 176 V+
FLAG 976 208 Vin1
FLAG 416 -48 0
FLAG 368 48 0
FLAG 416 256 0
FLAG 368 352 0
FLAG 416 192 V+
FLAG 128 48 0
FLAG 208 48 0
FLAG 128 352 0
FLAG 208 352 0
FLAG 800 -112 Vt
FLAG 800 192 Vt
FLAG 416 -112 V+
FLAG -928 -176 Vinr
FLAG -176 -64 Vinr
FLAG 896 -368 Vt
FLAG 672 -288 0
FLAG 416 -336 0
FLAG 368 -240 0
FLAG 416 -400 V+
FLAG -800 -496 V+
FLAG -800 -224 0
FLAG 672 592 0
FLAG 848 528 0
FLAG 848 464 V+
FLAG 976 496 Vin2
FLAG 416 544 0
FLAG 368 640 0
FLAG 416 480 V+
FLAG 128 640 0
FLAG 208 640 0
FLAG 800 480 Vt
FLAG 128 -240 0
FLAG 208 -240 0
FLAG -928 -16 0
FLAG 1776 -384 Vw
FLAG 1392 -352 0
FLAG 1344 -256 0
FLAG 1392 -416 V+
FLAG 1168 -368 Vinr
FLAG 1648 -304 0
SYMBOL res 688 -64 M270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R20
SYMATTR Value 10k
SYMBOL cap 656 0 M180
WINDOW 0 24 56 Left 2
WINDOW 3 24 8 Left 2
SYMATTR InstName C10
SYMATTR Value 100n
SYMBOL res 688 208 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R21
SYMATTR Value 10k
SYMBOL cap 656 240 R0
SYMATTR InstName C1
SYMATTR Value 100n
SYMBOL res 464 -176 R0
SYMATTR InstName R5
SYMATTR Value 100k
SYMBOL res 352 -48 R0
SYMATTR InstName R13
SYMATTR Value 10k
SYMBOL res 464 240 M180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R14
SYMATTR Value 100k
SYMBOL res 352 256 R0
SYMATTR InstName R18
SYMATTR Value 10k
SYMBOL cap 112 -48 R0
SYMATTR InstName C5
SYMATTR Value 680n
SYMBOL ind 192 -64 R0
SYMATTR InstName L5
SYMATTR Value 4.7m
SYMBOL res 144 -80 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R26
SYMATTR Value 2k
SYMBOL cap 112 256 R0
SYMATTR InstName C4
SYMATTR Value 150n
SYMBOL ind 192 240 R0
SYMATTR InstName L2
SYMATTR Value 4.7m
SYMBOL res 144 224 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R16
SYMATTR Value 2k
SYMBOL res -944 -192 R0
SYMATTR InstName R7
SYMATTR Value 100
SYMBOL res 688 -352 M270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R17
SYMATTR Value 10k
SYMBOL res 464 -464 R0
SYMATTR InstName R22
SYMATTR Value 100k
SYMBOL res 352 -336 R0
SYMATTR InstName R25
SYMATTR Value 10k
SYMBOL Misc\\battery -800 -368 R0
WINDOW 123 0 0 Left 0
WINDOW 39 24 44 Left 2
SYMATTR SpiceLine Rser=0
SYMATTR InstName V1
SYMATTR Value 3.6
SYMBOL cap -688 -336 R0
SYMATTR InstName C6
SYMATTR Value 1000µ
SYMATTR SpiceLine Rser=2
SYMBOL cap -592 -336 R0
SYMATTR InstName C7
SYMATTR Value 100n
SYMBOL res 688 496 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R6
SYMATTR Value 10k
SYMBOL cap 656 528 R0
SYMATTR InstName C8
SYMATTR Value 100n
SYMBOL res 464 528 M180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R8
SYMATTR Value 100k
SYMBOL res 352 544 R0
SYMATTR InstName R9
SYMATTR Value 10k
SYMBOL cap 112 544 R0
SYMATTR InstName C9
SYMATTR Value 150n
SYMBOL ind 192 528 R0
SYMATTR InstName L1
SYMATTR Value 2.7m
SYMBOL res 144 512 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R10
SYMATTR Value 2k
SYMBOL cap 112 -336 R0
SYMATTR InstName C12
SYMATTR Value 1µ
SYMBOL ind 192 -352 R0
SYMATTR InstName L3
SYMATTR Value 10m
SYMBOL res 144 -368 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R11
SYMATTR Value 2k
SYMBOL bv -928 -112 M0
SYMATTR InstName B1
SYMATTR Value V=0.3*sin(2*pi*time*10000*(time/2))*buf(-sin(time*400)+1.5)+0.1*sin(2*pi*(1592*time+0.5))
SYMBOL res 1440 -480 R0
SYMATTR InstName R2
SYMATTR Value 100k
SYMBOL res 1328 -352 R0
SYMATTR InstName R3
SYMATTR Value 10k
SYMBOL res 1664 -368 M270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R12
SYMATTR Value 10k
SYMBOL cap 1632 -304 M180
WINDOW 0 24 56 Left 2
WINDOW 3 24 8 Left 2
SYMATTR InstName C3
SYMATTR Value 100n
SYMBOL Opamps\\LT1079 416 448 R0
SYMATTR InstName U1
SYMBOL Opamps\\LT1079 848 432 R0
SYMATTR InstName U2
SYMBOL Opamps\\LT1079 848 144 R0
SYMATTR InstName U3
SYMBOL Opamps\\LT1079 416 160 R0
SYMATTR InstName U4
SYMBOL Opamps\\LT1079 416 -144 R0
SYMATTR InstName U5
SYMBOL Opamps\\LT1079 848 -160 R0
SYMATTR InstName U6
SYMBOL Opamps\\LT1079 416 -432 R0
SYMATTR InstName U7
SYMBOL Opamps\\LT1079 1392 -448 R0
SYMATTR InstName U8
SYMBOL res -816 -496 R0
SYMATTR InstName R4
SYMATTR Value 100m
SYMBOL cap -112 -80 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C2
SYMATTR Value 10µ
SYMBOL cap 656 -304 M180
WINDOW 0 24 56 Left 2
WINDOW 3 24 8 Left 2
SYMATTR InstName C13
SYMATTR Value 1µ
TEXT -1224 -336 Left 2 !.lib LM324.ti.lib
TEXT -1224 -296 Left 2 !.tran 0 1 0 0.001
TEXT 584 32 Left 2 ;smoothing f.
TEXT 584 336 Left 2 ;smoothing f.
TEXT 776 32 Left 2 ;comparator
TEXT 776 336 Left 2 ;comparator
TEXT 344 80 Left 2 ;rect. amp.
TEXT 424 368 Left 2 ;rect. amp.
TEXT -1040 -336 Left 2 !.lib Ltc.lib
TEXT 584 -256 Left 2 ;smoothing f.
TEXT 424 -224 Left 2 ;rect. amp.
TEXT -776 -392 Left 2 ;more capacitors beacause of ESR and ESL
TEXT -1320 104 Left 2 ;Motor noise: https://www.pololu.com/docs/0J15/9
TEXT -512 168 Left 2 ;bandwidth=1/(RC)/(2*pi) [Hz]
TEXT -512 192 Left 2 ;center frequency f_c= 1/sqrt(LC)/(2*pi) [Hz]
TEXT -512 216 Left 2 ;L = 1/(4*pi^2*f_c^2*C)
TEXT 584 624 Left 2 ;smoothing f.
TEXT 776 624 Left 2 ;comparator
TEXT 432 656 Left 2 ;rect. amp.
TEXT -48 -544 Left 2 ;If the 2 op-amp resistors are equal, A=1+R/R=2
TEXT 1400 -240 Left 2 ;rect. amp.
TEXT 1560 -272 Left 2 ;smoothing f.
TEXT -608 720 Left 2 ;SLEW RATE TOO LOW?\nhttps://www.electronics-notes.com/articles/analogue_circuits/operational-amplifier-op-amp/slew-rate.php
TEXT 200 96 Left 2 ;2815Hz
TEXT 200 392 Left 2 ;5994Hz
TEXT 200 680 Left 2 ;7908Hz
TEXT 192 -192 Left 2 ;1592Hz
TEXT -512 256 Left 2 ;Wider band results in less distortion\nof square signals, but this requires\nhigher inductances in the RLC circuits.
TEXT -1224 -256 Left 2 ;1s ~ 10kHz
LINE Normal 576 48 576 -128 2
LINE Normal 736 48 576 48 2
LINE Normal 736 -128 736 48 2
LINE Normal 576 -128 736 -128 2
LINE Normal 576 352 576 176 2
LINE Normal 736 352 576 352 2
LINE Normal 736 176 736 352 2
LINE Normal 576 176 736 176 2
LINE Normal 768 48 768 -176 2
LINE Normal 944 48 768 48 2
LINE Normal 944 -176 944 48 2
LINE Normal 768 -176 944 -176 2
LINE Normal 768 352 768 128 2
LINE Normal 944 352 768 352 2
LINE Normal 944 128 944 352 2
LINE Normal 768 128 944 128 2
LINE Normal 336 96 336 -176 2
LINE Normal 544 96 336 96 2
LINE Normal 544 -176 544 96 2
LINE Normal 336 -176 544 -176 2
LINE Normal 336 384 336 128 2
LINE Normal 544 384 336 384 2
LINE Normal 544 128 544 384 2
LINE Normal 336 128 544 128 2
LINE Normal 576 -240 576 -416 2
LINE Normal 736 -240 576 -240 2
LINE Normal 736 -416 736 -240 2
LINE Normal 576 -416 736 -416 2
LINE Normal 336 -208 336 -464 2
LINE Normal 544 -208 336 -208 2
LINE Normal 544 -464 544 -208 2
LINE Normal 336 -464 544 -464 2
LINE Normal 576 640 576 464 2
LINE Normal 736 640 576 640 2
LINE Normal 736 464 736 640 2
LINE Normal 576 464 736 464 2
LINE Normal 768 640 768 416 2
LINE Normal 944 640 768 640 2
LINE Normal 944 416 944 640 2
LINE Normal 768 416 944 416 2
LINE Normal 336 672 336 416 2
LINE Normal 544 672 336 672 2
LINE Normal 544 416 544 672 2
LINE Normal 336 416 544 416 2
LINE Normal 1312 -224 1312 -480 2
LINE Normal 1520 -224 1312 -224 2
LINE Normal 1520 -480 1520 -224 2
LINE Normal 1312 -480 1520 -480 2
LINE Normal 1552 -256 1552 -432 2
LINE Normal 1712 -256 1552 -256 2
LINE Normal 1712 -432 1712 -256 2
LINE Normal 1552 -432 1712 -432 2
