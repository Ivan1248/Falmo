Version 4
SHEET 1 2728 1604
WIRE -288 -480 -304 -480
WIRE -192 -480 -208 -480
WIRE -256 -384 -256 -400
WIRE -448 -368 -496 -368
WIRE -416 -368 -448 -368
WIRE -304 -368 -304 -480
WIRE -304 -368 -336 -368
WIRE -288 -368 -304 -368
WIRE -800 -352 -800 -368
WIRE -192 -352 -192 -480
WIRE -192 -352 -224 -352
WIRE -144 -352 -192 -352
WIRE -32 -352 -64 -352
WIRE 1200 -352 1200 -368
WIRE 1200 -352 1136 -352
WIRE -288 -336 -304 -336
WIRE 112 -336 16 -336
WIRE -416 -304 -496 -304
WIRE -304 -304 -304 -336
WIRE -304 -304 -416 -304
WIRE -256 -304 -256 -320
WIRE 688 -304 656 -304
WIRE 1136 -304 1136 -352
WIRE 1136 -304 1072 -304
WIRE 528 -288 464 -288
WIRE 944 -288 912 -288
WIRE 16 -272 16 -336
WIRE 32 -272 16 -272
WIRE 688 -272 656 -272
WIRE 1200 -272 1072 -272
WIRE 112 -256 112 -336
WIRE 112 -256 96 -256
WIRE 528 -256 496 -256
WIRE 944 -256 912 -256
WIRE 1200 -256 1200 -272
WIRE -32 -240 -32 -352
WIRE 32 -240 -32 -240
WIRE 688 -240 656 -240
WIRE 1104 -240 1072 -240
WIRE -416 -224 -416 -304
WIRE -400 -224 -416 -224
WIRE -304 -224 -320 -224
WIRE -288 -224 -304 -224
WIRE -192 -224 -208 -224
WIRE 688 -144 656 -144
WIRE -256 -128 -256 -144
WIRE 384 -128 384 -288
WIRE 528 -128 464 -128
WIRE -304 -112 -304 -224
WIRE -288 -112 -304 -112
WIRE 688 -112 656 -112
WIRE -928 -96 -928 -112
WIRE -688 -96 -688 -112
WIRE -192 -96 -192 -224
WIRE -192 -96 -224 -96
WIRE -144 -96 -192 -96
WIRE -32 -96 -32 -240
WIRE -32 -96 -64 -96
WIRE 528 -96 496 -96
WIRE -448 -80 -448 -368
WIRE -400 -80 -448 -80
WIRE -304 -80 -320 -80
WIRE -288 -80 -304 -80
WIRE 688 -80 656 -80
WIRE -304 -48 -304 -80
WIRE -256 -48 -256 -64
WIRE 544 0 528 0
WIRE -304 48 -304 32
WIRE 448 64 448 0
WIRE 464 64 448 64
WIRE 544 80 544 0
WIRE 544 80 528 80
WIRE 384 96 384 -128
WIRE 464 96 384 96
WIRE 448 128 448 64
WIRE -112 160 -448 160
WIRE -16 160 -32 160
WIRE 0 160 -16 160
WIRE 96 160 80 160
WIRE -400 208 -416 208
WIRE -304 208 -320 208
WIRE -192 208 -304 208
WIRE -256 256 -256 240
WIRE -16 256 -16 160
WIRE 0 256 -16 256
WIRE -304 272 -304 208
WIRE -288 272 -304 272
WIRE 96 272 96 160
WIRE 96 272 64 272
WIRE 128 272 96 272
WIRE -192 288 -224 288
WIRE -96 288 -192 288
WIRE 0 288 -16 288
WIRE -448 304 -448 160
WIRE -448 304 -496 304
WIRE -400 304 -448 304
WIRE -304 304 -320 304
WIRE -288 304 -304 304
WIRE -1072 320 -1232 320
WIRE -1056 320 -1072 320
WIRE -960 320 -976 320
WIRE -864 320 -960 320
WIRE -848 320 -864 320
WIRE -752 320 -768 320
WIRE 32 320 32 304
WIRE -1072 336 -1072 320
WIRE -960 336 -960 320
WIRE -304 336 -304 304
WIRE -256 336 -256 320
WIRE -16 336 -16 288
WIRE -864 416 -864 320
WIRE -848 416 -864 416
WIRE -1072 432 -1072 416
WIRE -1056 432 -1072 432
WIRE -960 432 -960 416
WIRE -960 432 -976 432
WIRE -752 432 -752 320
WIRE -752 432 -784 432
WIRE -416 432 -416 208
WIRE -416 432 -496 432
WIRE -960 448 -960 432
WIRE -848 448 -864 448
WIRE -416 464 -416 432
WIRE -304 464 -304 416
WIRE -304 464 -416 464
WIRE -16 464 -16 416
WIRE -16 464 -304 464
WIRE -864 480 -864 448
WIRE -1072 528 -1072 432
WIRE -1056 528 -1072 528
WIRE -960 528 -960 512
WIRE -960 528 -992 528
WIRE -1072 624 -1072 528
WIRE -1056 624 -1072 624
WIRE 1840 624 1664 624
WIRE -960 640 -960 528
WIRE -960 640 -992 640
WIRE -1056 656 -1072 656
WIRE 176 656 128 656
WIRE 208 656 176 656
WIRE 304 656 288 656
WIRE 512 656 304 656
WIRE 304 672 304 656
WIRE 1408 672 1376 672
WIRE 1520 672 1488 672
WIRE 1552 672 1520 672
WIRE 1664 672 1664 624
WIRE 1664 672 1632 672
WIRE 1680 672 1664 672
WIRE 1776 672 1744 672
WIRE -1072 688 -1072 656
WIRE -560 688 -592 688
WIRE -448 688 -480 688
WIRE -352 688 -448 688
WIRE -176 688 -272 688
WIRE 704 688 672 688
WIRE 816 688 784 688
WIRE 912 688 816 688
WIRE 1024 688 992 688
WIRE 1056 688 1024 688
WIRE 1152 688 1136 688
WIRE 1168 688 1152 688
WIRE 1264 688 1248 688
WIRE -32 720 -144 720
WIRE 1024 736 1024 688
WIRE 304 768 304 752
WIRE 320 768 304 768
WIRE 400 768 384 768
WIRE 912 784 912 768
WIRE 1520 784 1520 672
WIRE 1552 784 1520 784
WIRE 1664 784 1632 784
WIRE 1680 784 1664 784
WIRE 1776 784 1776 672
WIRE 1776 784 1744 784
WIRE -384 800 -384 784
WIRE -144 800 -144 720
WIRE -128 800 -144 800
WIRE 816 800 816 688
WIRE 880 800 816 800
WIRE 1152 800 1152 688
WIRE 1168 800 1152 800
WIRE -448 816 -448 688
WIRE -416 816 -448 816
WIRE -32 816 -32 720
WIRE -32 816 -64 816
WIRE 0 816 -32 816
WIRE 1024 816 1024 800
WIRE 1024 816 944 816
WIRE 1264 816 1264 688
WIRE 1264 816 1232 816
WIRE 1296 816 1264 816
WIRE -256 832 -352 832
WIRE -176 832 -176 688
WIRE -176 832 -192 832
WIRE -128 832 -176 832
WIRE 880 832 864 832
WIRE 1024 832 1024 816
WIRE 1168 832 1152 832
WIRE 1664 832 1664 784
WIRE 1840 832 1664 832
WIRE -416 848 -448 848
WIRE -96 864 -96 848
WIRE 352 864 352 848
WIRE 912 864 912 848
WIRE 1200 864 1200 848
WIRE -384 880 -384 864
WIRE 176 880 176 656
WIRE 192 880 176 880
WIRE 304 880 304 768
WIRE 304 880 272 880
WIRE 320 880 304 880
WIRE 336 880 320 880
WIRE 400 896 400 768
WIRE 400 896 384 896
WIRE 432 896 400 896
WIRE 512 896 512 656
WIRE 512 896 496 896
WIRE 560 896 512 896
WIRE 1024 896 1024 880
WIRE 320 912 288 912
WIRE 1696 912 1696 896
WIRE 816 928 816 800
WIRE 912 928 816 928
WIRE 1024 928 1024 896
WIRE 1024 928 992 928
WIRE 1152 928 1152 832
WIRE 1152 928 1024 928
WIRE 1520 928 1520 784
WIRE 1664 928 1520 928
WIRE 1680 928 1664 928
WIRE 352 944 352 928
WIRE 1776 944 1776 784
WIRE 1776 944 1728 944
WIRE 1904 944 1776 944
WIRE 1664 960 1632 960
WIRE 1552 976 1552 960
WIRE 1696 992 1696 976
FLAG -800 -368 V+
FLAG -800 -272 0
FLAG -928 -16 0
FLAG -256 -400 V+
FLAG -256 -304 0
FLAG -256 -144 V+
FLAG -256 -48 0
FLAG 64 -224 0
FLAG 64 -288 V+
FLAG -928 -112 IN
FLAG -384 784 V+
FLAG -384 880 0
FLAG -96 864 0
FLAG -448 848 0
FLAG -96 784 V+
FLAG -592 688 IN
FLAG -1024 672 0
FLAG -1024 608 V+
FLAG -816 464 0
FLAG -816 400 V+
FLAG -864 480 0
FLAG -1072 688 0
FLAG -1232 320 IN
FLAG -256 240 V+
FLAG -256 336 0
FLAG 32 320 0
FLAG 32 240 V+
FLAG -496 304 IN
FLAG 352 848 V+
FLAG 352 944 0
FLAG 288 912 0
FLAG 128 656 IN
FLAG 912 768 V+
FLAG 912 864 0
FLAG 1200 864 0
FLAG 864 832 0
FLAG 1200 784 V+
FLAG 672 688 IN
FLAG -496 -368 IN
FLAG 1696 896 V+
FLAG 1696 992 0
FLAG 1376 672 IN
FLAG 1552 976 0
FLAG -688 -16 0
FLAG -688 -112 IN2
FLAG -496 432 IN2
FLAG -496 -304 IN2
FLAG -304 48 0
FLAG 688 -240 V+
FLAG 688 -304 V+
FLAG 688 -272 IN-
FLAG 496 -256 0
FLAG 288 -384 IN-
FLAG 288 -464 V+
FLAG 688 -80 V+
FLAG 496 -96 0
FLAG 688 -112 V+
FLAG 688 -144 IN-
FLAG 496 112 0
FLAG 496 48 V+
FLAG 448 208 0
FLAG 1104 -240 V+
FLAG 912 -256 0
FLAG 1200 -368 V+
FLAG 1200 -176 0
SYMBOL voltage -928 -112 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value SINE(0 0.41 100)
SYMBOL voltage -800 -368 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V2
SYMATTR Value 3.6
SYMBOL res -192 -496 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R1
SYMATTR Value 1000k
SYMBOL res -320 -384 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R2
SYMATTR Value 10k
SYMBOL Opamps\\LT1078 -256 -416 R0
SYMATTR InstName U1
SYMBOL Opamps\\LT1078 -256 -160 R0
SYMATTR InstName U2
SYMBOL res -304 -240 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R3
SYMATTR Value 10k
SYMBOL res -304 -96 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R4
SYMATTR Value 10k
SYMBOL res -192 -240 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R5
SYMATTR Value 1000k
SYMBOL res -320 -64 R0
SYMATTR InstName R6
SYMATTR Value 1000k
SYMBOL res -48 -368 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R7
SYMATTR Value 1000k
SYMBOL res -48 -112 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R8
SYMATTR Value 1000k
SYMBOL Opamps\\LT1078 64 -320 R0
SYMATTR InstName U3
SYMBOL res -256 672 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R14
SYMATTR Value 200K
SYMBOL res -464 672 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R15
SYMATTR Value 200K
SYMBOL diode -256 848 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D3
SYMATTR Value 1N4148
SYMBOL Opamps\\opamp2 -96 752 R0
SYMATTR InstName U6
SYMATTR Value LT1078
SYMBOL Opamps\\opamp2 -384 768 R0
SYMATTR InstName U7
SYMATTR Value LT1078
SYMBOL Opamps\\opamp2 -1024 576 R0
SYMATTR InstName U9
SYMATTR Value LT1078
SYMBOL diode -992 512 R90
WINDOW 0 -1 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName D4
SYMATTR Value 1N4148
SYMBOL res -752 304 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R20
SYMATTR Value 1000
SYMBOL Opamps\\opamp2 -816 368 R0
SYMATTR InstName U10
SYMATTR Value LT1078
SYMBOL res -960 416 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R21
SYMATTR Value 100
SYMBOL res -1088 320 R0
SYMATTR InstName R22
SYMATTR Value 100
SYMBOL res -976 320 R0
SYMATTR InstName R23
SYMATTR Value 50
SYMBOL res -960 304 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R24
SYMATTR Value 100
SYMBOL diode -976 448 R0
SYMATTR InstName D5
SYMATTR Value 1N4148
SYMBOL res -16 144 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R33
SYMATTR Value 20k
SYMBOL res 96 144 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R35
SYMATTR Value 1000k
SYMBOL res -208 192 R0
SYMATTR InstName R34
SYMATTR Value 1000k
SYMBOL res -416 224 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R36
SYMATTR Value 20k
SYMBOL res 0 272 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R37
SYMATTR Value 1000k
SYMBOL res -32 320 R0
SYMATTR InstName R38
SYMATTR Value 41.6k
SYMBOL res -304 288 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R39
SYMATTR Value 20k
SYMBOL res -320 320 R0
SYMATTR InstName R40
SYMATTR Value 1000k
SYMBOL res 304 640 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R9
SYMATTR Value 2000K
SYMBOL diode 432 912 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D1
SYMATTR Value 1N4148
SYMBOL Opamps\\opamp2 352 832 R0
SYMATTR InstName U8
SYMATTR Value LT1078
SYMBOL res 288 864 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R11
SYMATTR Value 200K
SYMBOL diode 320 784 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D2
SYMATTR Value 1N4148
SYMBOL res 288 656 R0
SYMATTR InstName R12
SYMATTR Value 200K
SYMBOL res 1008 672 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R13
SYMATTR Value 20k
SYMBOL res 800 672 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R16
SYMATTR Value 20k
SYMBOL Opamps\\opamp2 1200 752 R0
SYMATTR InstName U4
SYMATTR Value LT1078
SYMBOL Opamps\\opamp2 912 752 R0
SYMATTR InstName U5
SYMATTR Value LT1078
SYMBOL diode 1008 736 R0
SYMATTR InstName D7
SYMATTR Value 1N4148
SYMBOL diode 1008 832 R0
SYMATTR InstName D6
SYMATTR Value 1N4148
SYMBOL res 1008 912 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R17
SYMATTR Value 20k
SYMBOL res 1152 672 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R18
SYMATTR Value 200K
SYMBOL res 1264 672 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R25
SYMATTR Value 200K
SYMBOL res 1648 656 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R19
SYMATTR Value 20k
SYMBOL Opamps\\opamp2 1696 880 R0
SYMATTR InstName U11
SYMATTR Value LT1078
SYMBOL res 1648 944 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R27
SYMATTR Value 20k
SYMBOL diode 1680 688 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D10
SYMATTR Value 1N4148
SYMBOL res 1648 768 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R28
SYMATTR Value 20k
SYMBOL diode 1744 768 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName D8
SYMATTR Value 1N4148
SYMBOL res 1504 656 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R10
SYMATTR Value 20k
SYMBOL Opamps\\LT1078 -256 224 R0
SYMATTR InstName U12
SYMBOL Opamps\\LT1078 32 208 R0
SYMATTR InstName U13
SYMBOL voltage -688 -112 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V3
SYMATTR Value SINE(0 0.40 100)
SYMBOL INA195 592 -272 R0
SYMATTR InstName U14
SYMBOL voltage 288 -480 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V4
SYMATTR Value SINE(0.000 0.01 100)
SYMBOL INA195 592 -112 R0
SYMATTR InstName U15
SYMBOL res 480 -304 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R26
SYMATTR Value 100k
SYMBOL res 480 -144 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R29
SYMATTR Value 100k
SYMBOL Opamps\\LT1079 496 16 R0
SYMATTR InstName U17
SYMBOL res 432 112 R0
SYMATTR InstName R32
SYMATTR Value 20k
SYMBOL res 544 -16 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R42
SYMATTR Value 20k
SYMBOL INA195 1008 -272 R0
SYMATTR InstName U16
SYMBOL res 1184 -368 R0
SYMATTR InstName R30
SYMATTR Value 10m
SYMBOL res 1184 -272 R0
SYMATTR InstName R31
SYMATTR Value 1
TEXT -1224 -296 Left 2 !;tran 0 0.5 0 0.0001
TEXT -1320 104 Left 2 ;Motor noise: https://www.pololu.com/docs/0J15/9
TEXT -1568 64 Left 2 ;V=0.2*(buf(-sin(2*pi*time*200)+0.5)-0.5)+0.2*(buf(-sin(2*pi*time*300)+0.5)-0.5)
TEXT -1224 -248 Left 2 !.tran 30m
TEXT 160 1016 Left 2 ;K=(1000/20+1)/(100/20-1)\nIncorrect: \nThe voltage on the + of the second amplifier needs to be 2*K*1000/20.\nThen the output voltage needs to be divided with a K/2*20*(1000-20)/(20+(1-K/2)(1000-20)) and a 20+(K/2-1)*(1000-20)  kOhm resistor
