Version 4
SHEET 1 1988 1604
WIRE -528 -352 -528 -384
WIRE -400 -352 -528 -352
WIRE -304 -352 -400 -352
WIRE -528 -336 -528 -352
WIRE -400 -320 -400 -352
WIRE -304 -320 -304 -352
WIRE -688 -304 -688 -320
WIRE -656 -304 -688 -304
WIRE -688 -288 -688 -304
WIRE 752 -288 704 -288
WIRE 1072 -288 960 -288
WIRE 176 -272 64 -272
WIRE -528 -224 -528 -256
WIRE -400 -224 -400 -256
WIRE -400 -224 -528 -224
WIRE -304 -224 -304 -256
WIRE -304 -224 -400 -224
WIRE 960 -224 960 -288
WIRE 976 -224 960 -224
WIRE -528 -208 -528 -224
WIRE 64 -208 64 -272
WIRE 80 -208 64 -208
WIRE 1072 -208 1040 -208
WIRE 1184 -208 1072 -208
WIRE 1392 -208 1264 -208
WIRE 176 -192 144 -192
WIRE 288 -192 176 -192
WIRE 496 -192 368 -192
WIRE 768 -192 736 -192
WIRE 976 -192 848 -192
WIRE 1264 -192 1264 -208
WIRE -128 -176 -160 -176
WIRE 80 -176 -48 -176
WIRE 368 -176 368 -192
WIRE 848 -176 848 -192
WIRE -48 -160 -48 -176
WIRE 960 -160 960 -224
WIRE 64 -144 64 -208
WIRE 848 -80 848 -112
WIRE -48 -64 -48 -96
WIRE 176 48 64 48
WIRE 512 96 496 96
WIRE 64 112 64 48
WIRE 80 112 64 112
WIRE 672 112 576 112
WIRE 176 128 144 128
WIRE 288 128 176 128
WIRE 512 128 368 128
WIRE -288 144 -352 144
WIRE -256 144 -288 144
WIRE -96 144 -176 144
WIRE 80 144 -96 144
WIRE 368 144 368 128
WIRE -176 160 -176 144
WIRE -96 160 -96 144
WIRE 64 176 64 112
WIRE -176 256 -176 224
WIRE -96 256 -96 240
WIRE 176 368 64 368
WIRE 512 416 496 416
WIRE 64 432 64 368
WIRE 80 432 64 432
WIRE 672 432 576 432
WIRE 176 448 144 448
WIRE 288 448 176 448
WIRE 512 448 368 448
WIRE -288 464 -288 144
WIRE -256 464 -288 464
WIRE -96 464 -176 464
WIRE 80 464 -96 464
WIRE 368 464 368 448
WIRE -176 480 -176 464
WIRE -96 480 -96 464
WIRE 64 496 64 432
WIRE -176 576 -176 544
WIRE -96 576 -96 560
FLAG -688 -208 0
FLAG 368 208 0
FLAG 368 528 0
FLAG 544 144 0
FLAG 544 80 V+
FLAG 672 112 Voutf
FLAG 544 464 0
FLAG 544 400 V+
FLAG 672 432 Voutb
FLAG -656 -304 Vin
FLAG 112 160 0
FLAG 64 256 0
FLAG 112 480 0
FLAG 64 576 0
FLAG 112 416 V+
FLAG -176 256 0
FLAG -96 256 0
FLAG -176 576 0
FLAG -96 576 0
FLAG 496 96 Vt
FLAG 496 416 Vt
FLAG 112 96 V+
FLAG -688 -400 Vinr
FLAG -352 144 Vinr
FLAG 496 -192 Vt
FLAG 368 -112 0
FLAG 112 -160 0
FLAG 64 -64 0
FLAG -48 -64 0
FLAG 112 -224 V+
FLAG -160 -176 Vinr
FLAG -528 -384 V+
FLAG -528 -208 0
FLAG 1392 -208 Ven
FLAG 1264 -128 0
FLAG 1008 -176 0
FLAG 960 -80 0
FLAG 848 -80 0
FLAG 1008 -240 V+
FLAG 736 -192 Vinr2
FLAG 704 -288 Vinr
FLAG 752 -288 Vinr2
SYMBOL bv -688 -304 M0
SYMATTR InstName B1
SYMATTR Value V=0.5*(sin(2*pi*time*1000*time)*buf(-sin(time*200)/2+0.5)+0.2*sin(2*pi*time*100))
SYMBOL res 384 144 M270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R20
SYMATTR Value 10k
SYMBOL cap 352 208 M180
WINDOW 0 24 56 Left 2
WINDOW 3 24 8 Left 2
SYMATTR InstName C10
SYMATTR Value 0.2µ
SYMBOL res 384 432 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R21
SYMATTR Value 10k
SYMBOL cap 352 464 R0
SYMATTR InstName C1
SYMATTR Value 0.2µ
SYMBOL res 160 32 R0
SYMATTR InstName R5
SYMATTR Value 10k
SYMBOL res 48 160 R0
SYMATTR InstName R13
SYMATTR Value 10k
SYMBOL res 160 464 M180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R14
SYMATTR Value 10k
SYMBOL res 48 480 R0
SYMATTR InstName R18
SYMATTR Value 10k
SYMBOL cap -192 160 R0
SYMATTR InstName C5
SYMATTR Value 200n
SYMBOL ind -112 144 R0
SYMATTR InstName L5
SYMATTR Value 47m
SYMBOL res -160 128 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R26
SYMATTR Value 2k
SYMBOL cap -192 480 R0
SYMATTR InstName C4
SYMATTR Value 200n
SYMBOL ind -112 464 R0
SYMATTR InstName L2
SYMATTR Value 47m
SYMBOL res -160 448 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R16
SYMATTR Value 2k
SYMBOL Opamps\\opamp2 112 64 R0
SYMATTR InstName U3
SYMATTR Value LT1078
SYMBOL Opamps\\opamp2 112 384 R0
SYMATTR InstName U4
SYMATTR Value LT1078
SYMBOL res -704 -416 R0
SYMATTR InstName R7
SYMATTR Value 200
SYMBOL res 384 -176 M270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R17
SYMATTR Value 5k
SYMBOL cap 352 -112 M180
WINDOW 0 24 56 Left 2
WINDOW 3 24 8 Left 2
SYMATTR InstName C11
SYMATTR Value 50µ
SYMBOL res 160 -288 R0
SYMATTR InstName R22
SYMATTR Value 5k
SYMBOL res 48 -160 R0
SYMATTR InstName R25
SYMATTR Value 1k
SYMBOL cap -64 -160 R0
SYMATTR InstName C14
SYMATTR Value 1µ
SYMBOL res -32 -192 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R29
SYMATTR Value 2k
SYMBOL Opamps\\opamp2 112 -256 R0
SYMATTR InstName U11
SYMATTR Value LT1078
SYMBOL Opamps\\opamp2 544 48 R0
SYMATTR InstName U2
SYMATTR Value LM324
SYMBOL Opamps\\opamp2 544 368 R0
SYMATTR InstName U5
SYMATTR Value LM324
SYMBOL Misc\\battery -528 -352 R0
WINDOW 123 0 0 Left 0
WINDOW 39 24 44 Left 2
SYMATTR SpiceLine Rser=2
SYMATTR InstName V1
SYMATTR Value 5
SYMBOL res 1280 -192 M270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R1
SYMATTR Value 10k
SYMBOL cap 1248 -128 M180
WINDOW 0 24 56 Left 2
WINDOW 3 24 8 Left 2
SYMATTR InstName C2
SYMATTR Value 5µ
SYMBOL res 1056 -304 R0
SYMATTR InstName R2
SYMATTR Value 5k
SYMBOL res 944 -176 R0
SYMATTR InstName R3
SYMATTR Value 1k
SYMBOL cap 832 -176 R0
SYMATTR InstName C3
SYMATTR Value 1µ
SYMBOL res 864 -208 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R4
SYMATTR Value 2k
SYMBOL Opamps\\opamp2 1008 -272 R0
SYMATTR InstName U1
SYMATTR Value LT1078
SYMBOL cap -416 -320 R0
SYMATTR InstName C6
SYMATTR Value 2200µ
SYMATTR SpiceLine Rser=2
SYMBOL cap -320 -320 R0
SYMATTR InstName C7
SYMATTR Value 100n
TEXT -1224 -336 Left 2 !.lib LM324.ti.lib
TEXT -1224 -296 Left 2 !.tran 0 3 0 0.05
TEXT -1240 -168 Left 2 ;V=0.35*sin(time*2*pi*(time*1000))
TEXT -1408 -136 Left 2 ;V=0.35*sin(time*2*pi*(time*1000))*buf(-sin(time*200)+0.75)
TEXT 280 240 Left 2 ;smoothing f.
TEXT 280 560 Left 2 ;smoothing f.
TEXT 480 240 Left 2 ;comparator
TEXT 472 560 Left 2 ;comparator
TEXT -1304 -8 Left 2 ;bandwidth=L/R/(2*pi) [Hz]
TEXT -1304 16 Left 2 ;center frequency f_c= 1/sqrt(LC)/(2*pi) [Hz] - check
TEXT 40 288 Left 2 ;rect. amp.
TEXT 48 608 Left 2 ;rect. amp.
TEXT -1040 -336 Left 2 !.lib Ltc.lib
TEXT 280 -80 Left 2 ;smoothing f.
TEXT 40 -32 Left 2 ;rect. amp.
TEXT 1176 -96 Left 2 ;smoothing f.
TEXT 936 -48 Left 2 ;rect. amp.
TEXT -504 -376 Left 2 ;more capacitors beacause of ESR and ESL
TEXT -1320 104 Left 2 ;Motor noise: https://www.pololu.com/docs/0J15/9
LINE Normal 272 256 272 80 2
LINE Normal 432 256 272 256 2
LINE Normal 432 80 432 256 2
LINE Normal 272 80 432 80 2
LINE Normal 272 576 272 400 2
LINE Normal 432 576 272 576 2
LINE Normal 432 400 432 576 2
LINE Normal 272 400 432 400 2
LINE Normal 464 256 464 32 2
LINE Normal 640 256 464 256 2
LINE Normal 640 32 640 256 2
LINE Normal 464 32 640 32 2
LINE Normal 464 576 464 352 2
LINE Normal 640 576 464 576 2
LINE Normal 640 352 640 576 2
LINE Normal 464 352 640 352 2
LINE Normal 32 304 32 32 2
LINE Normal 240 304 32 304 2
LINE Normal 240 32 240 304 2
LINE Normal 32 32 240 32 2
LINE Normal 32 624 32 352 2
LINE Normal 240 624 32 624 2
LINE Normal 240 352 240 624 2
LINE Normal 32 352 240 352 2
LINE Normal 272 -64 272 -240 2
LINE Normal 432 -64 272 -64 2
LINE Normal 432 -240 432 -64 2
LINE Normal 272 -240 432 -240 2
LINE Normal 32 -16 32 -288 2
LINE Normal 240 -16 32 -16 2
LINE Normal 240 -288 240 -16 2
LINE Normal 32 -288 240 -288 2
LINE Normal 1168 -80 1168 -256 2
LINE Normal 1328 -80 1168 -80 2
LINE Normal 1328 -256 1328 -80 2
LINE Normal 1168 -256 1328 -256 2
LINE Normal 928 -32 928 -304 2
LINE Normal 1136 -32 928 -32 2
LINE Normal 1136 -304 1136 -32 2
LINE Normal 928 -304 1136 -304 2
